<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reading Legacy Census Redistricting Data • PL94171</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Reading Legacy Census Redistricting Data">
<meta property="og:description" content="PL94171">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-79274202-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-79274202-5');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PL94171</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/PL94171.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CoryMcCartan/PL94171/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="PL94171_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Reading Legacy Census Redistricting Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CoryMcCartan/PL94171/blob/master/vignettes/PL94171.Rmd"><code>vignettes/PL94171.Rmd</code></a></small>
      <div class="hidden name"><code>PL94171.Rmd</code></div>

    </div>

    
    
<p>The US Census Bureau releases redistricting data (P.L. 94-171) following the decennial census. This article walks through the basics of reading that data and getting it into working form.</p>
<div id="the-p-l--94-171-legacy-file" class="section level1">
<h1 class="hasAnchor">
<a href="#the-p-l--94-171-legacy-file" class="anchor"></a>The P.L. 94-171 Legacy File</h1>
<p>The redistricting data mandated by P.L. 94-171 is composed of <a href="https://www2.census.gov/programs-surveys/decennial/2020/technical-documentation/complete-tech-docs/summary-file/2020Census_PL94_171Redistricting_StatesTechDoc_English.pdf">six tables, five of population characteristics, and one of housing characteristics</a>. In the legacy data format, these six tables (and dozens of levels of geography) are split into four files: File01, File02, File03, and the Geographic Header Record. Files 01–03 have the actual decennial census data for each table, while the geographic header has geographic identifiers (FIPS code, precinct IDs, etc.) and information (area, water, etc.).</p>
<div class="figure">
<img src="../man/figures/pl94171_layout.png" alt=""><p class="caption">P.L. 94-171 file layout</p>
</div>
<p>These four files have the same rows, each of which is identified by a <code>LOGRECNO</code> number. Combining the columns shared across the four files yields the full P.L. 94-171 file</p>
<p>The basic unit of Census geography is the block; all other geographies are constructed from them. But the P.L. 94-171 file is not composed of blocks alone. The Census has already tabulated the six table statistics across every possible level of geographies. To get information for a single geography level—blocks, or counties, or school districts—one needs only to subset to the rows which correspond to this geographic level (coded in the <code>SUMLEV</code> column).</p>
<p>So the basic process for working with legacy P.L. 94-171 data is:</p>
<ol style="list-style-type: decimal">
<li>Read in the four P.L. files (<code><a href="../reference/pl_read.html">pl_read()</a></code>, <code><a href="../reference/pl_url.html">pl_url()</a></code>)</li>
<li>Combine the four files into one, and subset to the desired geography level (<code><a href="../reference/pl_subset.html">pl_subset()</a></code>; geography level codes listed in <code>pl_geog_levels</code>)</li>
<li>Select the desired variables from the six included tables (<code><a href="../reference/pl_select_standard.html">pl_select_standard()</a></code>)</li>
<li>Optionally, combine the processed data with the corresponding <a href="https://cran.r-project.org/package=tigris"><code>tigris</code> shapefile</a>.</li>
</ol>
<p>The utility function <code><a href="../reference/pl_tidy_shp.html">pl_tidy_shp()</a></code> combines all of these steps into one function for most common use case of tabulating basic redistricting information at the block level. This is demonstrated in <a href="../index.html">the README</a></p>
</div>
<div id="using-the-pl94171-package" class="section level1">
<h1 class="hasAnchor">
<a href="#using-the-pl94171-package" class="anchor"></a>Using the <code>PL94171</code> package</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://corymccartan.github.io/PL94171/">PL94171</a></span><span class="op">)</span></code></pre></div>
<p>The four components of the P.L. 94-171 file should be downloaded into their own directory. Here, we’ll use the example data included in the package, from the 2018 end-to-end Census test in Providence County, Rhode Island, and read it into our R session. In general, you can provide a URL in place of a file path, and the package will read the data from the URL. The <code><a href="../reference/pl_url.html">pl_url()</a></code> function will automatically construct the URL to the data for a given state and year.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># `extdata/ri2018_2020Style.pl` is a directory with the four P.L. 94-171 files</span>
<span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/ri2018_2020Style.pl"</span>, package <span class="op">=</span> <span class="st">"PL94171"</span><span class="op">)</span>
<span class="va">pl_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pl_read.html">pl_read</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>
<span class="co"># try `pl_read(pl_url("RI", 2010))`</span></code></pre></div>
<p>This creates a large list where each individual P.L. 94-171 file component is a separate entry in the list. If we look at the top of one of these entries, we see the same structure as in the schematic above: each redistricting variable is a column, the rows are indexed by <code>LOGRECNO</code>, and various levels of aggregation are all included as different sets of rows in the same table (notice the countywide population counts in the first two rows).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pl_raw</span><span class="op">$</span><span class="va">`00003`</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 15</span>
<span class="co">#&gt;   FILEID STUSAB CHARITER CIFSN LOGRECNO P0050001 P0050002 P0050003 P0050004</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1 PLST   RI     000      03           1    15766     7311     3266      261</span>
<span class="co">#&gt; 2 PLST   RI     000      03           2    15766     7311     3266      261</span>
<span class="co">#&gt; 3 PLST   RI     000      03          19      732        0        0        0</span>
<span class="co">#&gt; 4 PLST   RI     000      03          20        0        0        0        0</span>
<span class="co">#&gt; 5 PLST   RI     000      03          21        1        0        0        0</span>
<span class="co">#&gt; 6 PLST   RI     000      03          22        1        1        0        0</span>
<span class="co">#&gt; # … with 6 more variables: P0050005 &lt;int&gt;, P0050006 &lt;int&gt;, P0050007 &lt;int&gt;,</span>
<span class="co">#&gt; #   P0050008 &lt;int&gt;, P0050009 &lt;int&gt;, P0050010 &lt;int&gt;</span></code></pre></div>
<p>To subset to a desired geography level, we must first identify the corresponding <code>SUMLEV</code> code.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pl_geog_levels</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 85 x 2</span>
<span class="co">#&gt;    SUMLEV SUMLEV_description                                     </span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;                                                  </span>
<span class="co">#&gt;  1 040    State                                                  </span>
<span class="co">#&gt;  2 050    State-County                                           </span>
<span class="co">#&gt;  3 060    State-County-County Subdivision                        </span>
<span class="co">#&gt;  4 067    State-County-County Subdivision-Subminor Civil Division</span>
<span class="co">#&gt;  5 140    State-County-Census Tract                              </span>
<span class="co">#&gt;  6 150    State-County-Census Tract-Block Group                  </span>
<span class="co">#&gt;  7 155    State-Place-County                                     </span>
<span class="co">#&gt;  8 160    State-Place                                            </span>
<span class="co">#&gt;  9 170    State-Consolidated City                                </span>
<span class="co">#&gt; 10 172    State-Consolidated City-Place within Consolidated City </span>
<span class="co">#&gt; # … with 75 more rows</span></code></pre></div>
<p>Here, we’ll look at Census tracts, which are <code>SUMLEV=140</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pl_subset.html">pl_subset</a></span><span class="op">(</span><span class="va">pl_raw</span>, sumlev<span class="op">=</span><span class="st">"140"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">pl</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1]   7 397</span></code></pre></div>
<p>We see that all four components have been combined into one large table, with data for each of the seven Census tracts in the example file recorded in a single row. To extract <a href="../reference/pl_select_standard.html">commonly-used variables</a> from the 397 columns, we can run the following:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pl_select_standard.html">pl_select_standard</a></span><span class="op">(</span><span class="va">pl</span>, clean_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pl</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 7 x 24</span>
<span class="co">#&gt;   GEOID       state county row_id summary_level vtd     pop pop_hisp pop_white</span>
<span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;         &lt;chr&gt; &lt;int&gt;    &lt;int&gt;     &lt;int&gt;</span>
<span class="co">#&gt; 1 44007000101 RI    007        19 140           &lt;NA&gt;   3970     1442      1445</span>
<span class="co">#&gt; 2 44007000102 RI    007        20 140           &lt;NA&gt;   4735     2555       815</span>
<span class="co">#&gt; 3 44007000200 RI    007        21 140           &lt;NA&gt;   5703     3766       570</span>
<span class="co">#&gt; 4 44007000300 RI    007        22 140           &lt;NA&gt;   6647     3827       754</span>
<span class="co">#&gt; 5 44007000400 RI    007        23 140           &lt;NA&gt;   3433     2130       142</span>
<span class="co">#&gt; 6 44007000500 RI    007        24 140           &lt;NA&gt;   2940     2249        39</span>
<span class="co">#&gt; 7 44007000600 RI    007        25 140           &lt;NA&gt;   1797      778       170</span>
<span class="co">#&gt; # … with 15 more variables: pop_black &lt;int&gt;, pop_aian &lt;int&gt;, pop_asian &lt;int&gt;,</span>
<span class="co">#&gt; #   pop_nhpi &lt;int&gt;, pop_other &lt;int&gt;, pop_two &lt;int&gt;, vap &lt;int&gt;, vap_hisp &lt;int&gt;,</span>
<span class="co">#&gt; #   vap_white &lt;int&gt;, vap_black &lt;int&gt;, vap_aian &lt;int&gt;, vap_asian &lt;int&gt;,</span>
<span class="co">#&gt; #   vap_nhpi &lt;int&gt;, vap_other &lt;int&gt;, vap_two &lt;int&gt;</span></code></pre></div>
<p>Above, we set <code>clean_names = TRUE</code>, which is the default. This creates a set of variables familiar to the <code>redist</code> family of packages.</p>
<p>To combine these data with a shapefile, we must use the <code>tigris</code> package. The <code>GEOID</code> column is shared between the P.L. 94-171 data and the TIGER shapefiles from <code>tigris</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/walkerke/tigris">tigris</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="va">ri_tracts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tigris/man/tracts.html">tracts</a></span><span class="op">(</span><span class="st">"RI"</span>, county<span class="op">=</span><span class="st">"Providence"</span>, year<span class="op">=</span><span class="fl">2020</span>, progress_bar<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">pl</span>, <span class="va">ri_tracts</span>, by<span class="op">=</span><span class="st">"GEOID"</span><span class="op">)</span> <span class="op">%&gt;%</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">pop</span>, geometry<span class="op">=</span><span class="va">geometry</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="PL94171_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Cory McCartan, Christopher T. Kenny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
